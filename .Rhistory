min(MaleData$Age)
max(MaleData$Age)
MaleOverFifty <- MaleData[Age>=15,]
MaleOverFifty
MaleOver15 <- lcd[Gender=="male" & Age>=15]
MaleOver15 <- lcd[Gender=="male" & Age>=15,]
MaleOver15
dim(MaleOver15)
head(MaleOver15)
x0 <- rep(1,13)
x0
t(x0)
xObs <- c(28,20,32,22,29,27,28,26,21,27,29,23,25)
z1 <- c(1,1,1,1,0,0,0,0,0,0,0,0,0)
z2 <- c(0,0,0,0,1,1,1,1,0,0,0,0,0)
ls()
rm(ls=ls())
x0 <- rep(1,13)
xObs <- c(28,20,32,22,29,27,28,26,21,27,29,23,25)
z1 <- c(1,1,1,1,0,0,0,0,0,0,0,0,0)
z2 <- c(0,0,0,0,1,1,1,1,0,0,0,0,0)
rm(list = ls())
x0 <- rep(1,13)
xObs <- c(28,20,32,22,29,27,28,26,21,27,29,23,25)
z1 <- c(1,1,1,1,0,0,0,0,0,0,0,0,0)
z2 <- c(0,0,0,0,1,1,1,1,0,0,0,0,0)
yobs <- c(13.3,8.9,15.1,10.4,13.1,12.4,13.2,11.8,11.5,14.2,15.4,13.1,13.8)
ls()
# b = (xt x)^-1 xt y
length(x0)
length(x2)
# b = (xt x)^-1 xt y
length(x0)
length(xobs)
xObs <- c(28,20,32,22,29,27,28,26,21,27,29,23,25)
z1 <- c(1,1,1,1,0,0,0,0,0,0,0,0,0)
z2 <- c(0,0,0,0,1,1,1,1,0,0,0,0,0)
yobs <- c(13.3,8.9,15.1,10.4,13.1,12.4,13.2,11.8,11.5,14.2,15.4,13.1,13.8)
length(xobs)
xobs <- c(28,20,32,22,29,27,28,26,21,27,29,23,25)
length(xobs)
length(yobs)
length(z1)
length(z2)
x <- matrix(x0,xobs,z1,z2)
x
x
x0
x <- c(x0,xobs,z1,z2)
x
x <- matrix(x,nrow=13,ncol=4)
x
t(x)
# b <-(xtrans x)^-1 xtrans y
b <-(t(x)%*%x)^-1 * t(x) * yobs
tansx <- t(x)
t(x)
x*transx
x%*%transx
tansx <- t(x)
x%*%transx
x
x*x
t(x)*x
xx<-t(x)*x
xx
rm(list = ls())
x <- 10
y <- 12
x+y
sum(x,y)
sum(x+y)
x-y
x*y
x/y
z <- 1:100
z
sum(z)
z
rm(list=ls())
x <- seq(1,5)
y <- c(1,1,2,2,3)
Ad <- seq(1,5)
Sales <- c(1,1,2,2,3)
plot(Ad,Sales,main="Scatter plot of Ad vs Sales",las=1)
plot(Ad,Sales,main="Scatter plot of Ad vs Sales",las=1,cex.main=2)
plot(Ad,Sales,main="Scatter plot of Ad vs Sales",las=1,cex.main=1.5)
plot(Ad,Sales,main="Scatter plot of Ad vs Sales",las=1,cex.main=1.5,col=4,pch=15,cex=2)
plot(Ad,Sales,main="Scatter plot of Ad vs Sales",las=1,cex.main=1.5,col=4,cex=2)
a <- c(1,10)
b <- c(1,3,2,4,6,5,7,5,7,20)
plot(a,b)
a <- seq(1,10)
b <- c(1,3,2,4,6,5,7,5,7,20)
plot(a,b)
legend(10,16,legend = "A")
legend(8,16,legend = "A")
legend(9,18,legend = "A")
legend(9,20,legend = "A")
legend(9,21,legend = "A")
legend(9,20,legend = "A")
a <- seq(1,10)
b <- c(1,3,2,4,6,5,7,5,7,20)
plot(a,b)
legend(9,20,legend = "A")
a <- seq(1,10)
b <- c(1,5,2,7,6,9,8,12,10,20)
plot(a,b)
legend(9,20,legend = "A")
a <- seq(1,10)
b <- c(1,5,2,7,6,9,8,12,10,18)
plot(a,b)
legend(9,20,legend = "A")
a <- seq(1,10)
b <- c(1,5,2,7,6,9,8,12,10,18)
plot(a,b)
legend(9,18,legend = "A")
a <- seq(1,10)
b <- c(1,5,2,7,6,9,8,12,10,18)
plot(a,b,main="A is the leverage point")
legend(9,18,legend = "A")
x <- seq(1,20)
y <- c(2,2,2,2,,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,16,16,16)
y <- c(2,2,2,2,2,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,16,16,16)
length(y)
x <- seq(1,23)
y <- c(2,2,2,2,2,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,16,16,16)
length(y)
plot(x,y)
plot(x,y,xlim=c(1,25),ylim=c(1,25))
x1 <- rep(2,5)
x2 <- rep(3,20,2)
x2
x2 <- c(3,20,2)
x2
x2 <- seq(3,20,2)
x3 <- rep(21,5)
y <- x1+x2+x3
y <- c(x1,x2,x3)
x <- seq(1,23)
x1 <- rep(2,5)
x2 <- seq(3,20,2)
x3 <- rep(21,5)
y <- c(x1,x2,x3)
plot(x,y)
length(y)
x <- seq(1,19)
x1 <- rep(2,5)
x2 <- seq(3,20,2)
x3 <- rep(21,5)
y <- c(x1,x2,x3)
plot(x,y)
plot(x,y,xlim=c(1,25),ylim=c(1,25))
plot(x,y,xlim=c(1,25),ylim=c(1,25),pty="l")
df <- read.table(file.choose(),header=T,sep="\t")
Smoke =as.factor(df$Smoke)
Gender = as.factor(df$Gender)
lcd = data.frame(df$LungCap,df$Age,df$Height,Smoke,Gender)
head(lcd)
rm(df)
rm(Gender)
rm(Smoke)
attach(lcd)
plot(Age,LungCap,main="title",las=1)
names(lcd)
plot(Age,df.LungCap,main="title",las=1)
plot(df.Age,df.LungCap,main="title",las=1)
cor(df.Age,df.LungCap)
r <-cor(df.Age,df.LungCap)
text(x=5,y=11,label=r,adj=0)
abline(h=mean(df.LungCap),cex=3,col=4)
abline(v=quantile,prob=.5,col=4,cex=3)
abline(v=mean(df.LungCap),col=4,cex=3)
x <- rrand(100,75,5)
x <- rnorm(100,75,5)
d <- dnorm(x,75,5)
plot(x,d)
line(h=c(x,y))
?hline
/line(h)
?line(h)
line(h=mean(x))
abline(v=mean(x))
abline(v=80
)
a <- c(5,10,8,5,7,10,5,9,7,10,11,15)
b <- seq(1,length(a))
plot(b,a)
abline(h=mean(a))
abline(h=mean(a),cex=3)
plot(b,a)
abline(h=mean(a),cex=3)
a <- c(5,10,8,5,7,10,5,9,7,10,11,15)
length(a)
b <- seq(1,12)
plot(b,a)
a <- c(5,10,8,5,7,10,5,9,7,10,11)
b <- seq(1,11)
plot(a,b,ylim=c(4,5,6,7,8,9,10),xlim=seq(1,15))
plot(a,b,y)
plot(a,b)
a
abline(h=mean(a))
plot(a,b)
abline(h=mean(x),cex=10)
abline(h=mean(a),cex=10)
plot(b,a)
abline(h=mean(a))
x <- rnorm(10,75,5)
x
p <- dnorm(x,75,5)
p
z <- dnorm(0,0,1)
z
x <- rnomr(1000,75,5)
x <- rnorm(1000,75,5)
p <-dnorm(x,75,5)
plot(x,p)
mean(x)
var(x)
abline(v=75)
d <- pnorm(x[1:50],75,5)
d[50]
x <- rnorm(100000,0,1)
x[1:10]
x[1:100]
x
x
p <- dnorm(x,0,1)
plot(x,p)
p <- dnorm(x,0,1)
plot(x,p)
b <- seq(0,100000)
for (i in 100000){
b[i]<-x[i]-p[i]
}
b[1:100]
b <- seq(0,100000)
for (i in 100000){
b[i]<-(x[i]-p[i])^2
}
b[1:10]
plot(b)
for (i in 1:10){
print(i)
}
for (i in 10){
print(i)
}
for (i in 1:100000){
b[i]<-(x[i]-p[i])^2
}
plot(b)
x <- c(4,3,2)
pie(x,col=c(4,3,2))
help(pie)
y <- c("4","3","2")
pie(x,col=c(4,3,2),labels = y)
a <- "E:/DS/six_month/3rd R/Marinstat R"
setwd(a)
getwd()
x <-scan()
x
rm(x)
rm(list=ls())
df <- read.table(file.choose(),header=True,sep="\t")
attach(df)
Smoke <- as.factor(Smoke)
Smoke[1:10]
names(df)
df <- read.table(file.choose(),header=True,sep="\t")
df <- read.table(file.choose(),header=T,sep="t")
df <- read.table(file.choose(),header=T,sep="\t")
attach(df)
names(df)
Smoke <- as.factor(Smoke)
Gender <- as.factor(Gender)
Caesarean[1:4]
Caesarean <- as.factor(Caesarean)
LungCap <- LungCap
Age <- Age
lcd <- data.frame(LungCap,Age,Height,Smoke,Gender,Caesarean)
naems(lcd)
names(lcd)
help(cut)
# Multiple Linear Regression -----------------------
CatHeight <- cut(Height,breaks = c(0,50,55,60,65,70,75,100),labels = c("A","B","C","D","E","F","G"))
#help(cut)
levels(CatHeight)
class(CatHeight)
table(CatHeight)
hist(CatHeight)
plot(CatHeight)
min(Height)
max(Height)
mean(LungCap[CatHeight=="A"])
mean(LungCap[CatHeight=="A"])
mean(LungCap[CatHeight=="B"])
mean(LungCap[CatHeight=="C"])
mean(LungCap[CatHeight=="D"])
mean(LungCap[CatHeight=="E"])
mean(LungCap[CatHeight=="F"])
mean(LungCap[CatHeight=="G"])
#----------Regression Starts here-------------------
mod <- lm(LungCap~CatHeight)
names(lcd)
summary(mod)
qf(0.05,6,718,lower.tail = F)
help("relevel")
# working on the LungCapData
mod1 <- lm(LungCap~Age+Smoke)
summary(mod1)
qf(0.05,3,722,lower.tail = F)
a =function(a,b){
sam = a+b
return(sam)
}
a(14,7)
Smoke[1:20]
table(Smoke)
Smooke <- relevel(Smoke,ref="yes")
table(Smooke)
mod2 <- lm(LungCap~Age+Smooke)
summary(mod2)
rm(list=ls())
# importing the data first.
df <- read.table(file.choose(),heade=T,sep="\t")
Smoke <- as.factor(df$Smoke)
Gender <- as.fcotor(df$Gender)
Caesarean <- as.factor(df$Caesarean)
LungCap <- df$LungCap
Age <- df$Age
Height <- df$Height
Gender <- factor(df$Gender)
lcd <- data.frame(LungCap,Age,Height,Smoke,Gender,Caesarean)
rm(Smoke)
rm(df)
rm(Gender)
rm(Age)
rm(Caesarean)
rm(Height)
rm(LungCap)
ls()
#------------------------------------
attach(lcd)
# fitting polynomial regression
# y = b0 +b1*Age+b2*Age^2
Full.model <- lm(LungCap~Age+I(Age^2))
Reduced.model <- lm(LungCap~Age)
summary(Full.model)
summary(Reduced.model)
# anova
anova(Full.model,Reduced.model)
help(f)
help(F())
df(0.05,722,723)
#----------------another example----------------------
model1 <- lm(LungCap~Age+Gender+Smoke+Height)
# excluded the height from the full model
model2 <- lm(LungCap~Age+Gender+Smoke)
summary(model1)
summary(model2)
aov(model1,model2)
anova(model1,model2)
anova(model2,model1)
library(readxl)
LungCapData2 <- read_excel("LungCapData2.xlsx")
View(LungCapData2)
# will be working on the same previous LungCapData2.txt
library(readxl)
LungCapData2 <- read_excel("LungCapData2.xlsx")
View(LungCapData2)
class(LungCapData2$Gender)
names(LungCapData2)
Gender <- as.factor(LungCapData2$Gender)
Smoke <- as.factor(LungCapData2$Smoke)
View(lcd)
lcd2 <- data.frame(lungcap,age,Height,Gender,Smoke)
age <-LungCapData2$Age
lungcap <- LungCapData2$LungCap
Height <- LungCapData2$Height
Gender <- as.factor(LungCapData2$Gender)
Smoke <- as.factor(LungCapData2$Smoke)
lcd2 <- data.frame(lungcap,age,Height,Gender,Smoke)
# data importing done
attach(lcd2)
plot(Height,lungcap,main="Polynomial Regression",las=1)
abline(lm(lungcap~age))
model1 <- lm(lungcap~Height)
summary(model1)
plot(Height,lungcap,main="Polynomial Regression",las=1)
abline(model1)
plot(model1)
# wrong way to fit polynomial regression model
model2 <- lm(lungcap~Height+Height^2)
summary(model2)
# right way to fit polynomial regression model
model3 <- lm(lungcap~Height+I(Height^2))
summary(model3)
# another way to do it
heightSq <- Height^2
Height[1:10]
heightSq[1:10]
lcd2 <- data.frame(lcd2,heightSq)
names(lcd2)
model4 <- lm(lungca~Height+heightSq)
model4 <- lm(lungcap~Height+heightSq)
summary(model4)
# poly command in multiple linear regression
mode5 <- lm(lungcap~poly(Height,degree=2,raw=T))
summary(mode5)
lines(smooth.spline(Height,predict(mode5),col="blue",lwd=3))
model4 <- lm(lungcap~Height+heightSq)
game = function(a,b,c){
if (a>b & a>c){
print("A is the greatest")
return(a)
}else if (b>a & b>c){
print("B is the greatest")
return (b)
}else{
print("C is the greatest")
return(c)
}
}
game(232,534,23)
game2 = function(x,y,z){
if (x>y){
if(x>z){
print("X is the greatest")
return(x)
}else if(y>x){
if(y>z){
print("Y is the greatest")
return(y)
}else{
print("Z is the greatest")
return(z)
}
}
}
}
game2(12,2,54)
game(34,3543,34)
game2(45474,744,87)
rm(list=ls())
x <- seq(1,10)
y <- c(10,15,12,10,18,15,17,25,14,20)
plot(x,y,main="The plot of x and y",las=1)
ab <- lm(y~x)
abline(ab)
# will be working on the same previous LungCapData2.txt
library(readxl)
LungCapData2 <- read_excel("LungCapData2.xlsx")
View(LungCapData2)
ge <-LungCapData2$Age
lungcap <- LungCapData2$LungCap
Height <- LungCapData2$Height
Gender <- as.factor(LungCapData2$Gender)
Smoke <- as.factor(LungCapData2$Smoke)
lcd2 <- data.frame(lungcap,age
lcd2 <- data.frame(lungcap,age,Height,Gender,Smoke)
lcd2 <- data.frame(lungcap,age,Height,Gender,Smoke)
# data importing done
attach(lcd2)
plot(Height,lungcap,main="Polynomial Regression",las=1)
abline(lm(lungcap~age))
rm(list=ls())
library(readxl)
lcd2 <- read_excel("LungCapData2.xlsx")
View(lcd2)
class(lcd2$Height)
plot(lcd2$LungCap,lcd2$Height,main="LungCap vs Height",las=1)
plot(lcd2$Height,lcd2$LungCap,main="LungCap vs Height",las=1)
model1 <- lm(lcd2$LungCap~lcd2$Height)
summary(model1)
abline(model1,lwd=3,col="red")
# wrong way to fit polynomial regression
model2 <- lm(lcd2$LungCap~lcd2$Height+lcd2$Height^2)
summary(model2)
# right way to fit polynomial regression
model3 <- lm(lm(lcd2$LungCap~lcd2$Height+I(lcd2$Height^2)
)
summary(model3)
lcd2
# right way to fit polynomial regression
model3 <- lm(lcd2$LungCap~lcd2$Height+I(lcd2$Height^2))
summary(model3)
# You can make a new vector of Height square and fit the multiple regression
# you can also use "poly" to fit this model
model4 <- lm(lcd2$LungCap~poly(lcd2$Height,degrer=2,raw=T))
summary(model4)
model4 <- lm(lcd2$LungCap~poly(lcd2$Height,degrer=2,raw=F))
summary(model4)
# raw = F will fit a orthogonal polynomial
attach(lcd2)
lines(smooth.spline(Height,predict(model2)),col="blue",lwd=3)
lines(smooth.spline(Height,predict(model3)),col="blue",lwd=3)
summary(model1)
summary(model3)
# partial F test
#Ho: There is no significant diff in two model
#H1: The full model with Height^2 is better than the model just including Height
anova(model3,model1)
df(0.05,651,652)
# with degree 3
model6 <- lm(LungCap~Height+I(Height^2)+I(Height^3))
summary(model6)
lines(smooth.spline(Height,predict(model6)),lwd=3,col="green")
anova(model5,model6)
anova(model3,model6)
legend(46,12,legend=c("model1","model3","model6"),col=c(4,3,2),lty=c(1,1,1),lwd=3,cex=0.9)
